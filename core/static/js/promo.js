// Generated by CoffeeScript 1.6.3
(function() {
  var $;

  $ = jQuery;

  $(function() {
    var advance_callback, advance_interval, advance_slideshow, promo_callback, tick_counter, ticks_before_slide;
    advance_interval = null;
    ticks_before_slide = 5;
    tick_counter = 0;
    $('#promo-controls li:first').addClass('selected');
    $('#promo-controls li').click(function() {
      var $promo_line, $this;
      clearInterval(advance_interval);
      $('#promo-slideshow .progress-indicator').fadeOut('slow');
      $this = $(this);
      $promo_line = $('#promo-line');
      return advance_slideshow($this.index());
    });
    advance_slideshow = function(index) {
      var $promo_line, $selected;
      $selected = $("#promo-controls li:nth-child(" + (index + 1) + ")");
      if (index === void 0) {
        index = $selected.index();
      }
      $selected.siblings().removeClass('selected');
      $selected.addClass('selected');
      $promo_line = $('#promo-line');
      return $promo_line.stop().animate({
        'left': ($('#promo-frame').width() * index * -1) + 'px'
      }, 1000, 'easeOutBack');
    };
    advance_callback = function() {
      var $selected, animation_timer;
      tick_counter++;
      if (ticks_before_slide < tick_counter) {
        $selected = $('#promo-controls li').filter(function() {
          return $(this).hasClass('selected');
        });
        if (($selected.next().length)) {
          advance_slideshow($selected.next().index());
        } else {
          advance_slideshow(0);
        }
        $('#promo-slideshow .progress-indicator .fill').stop().css({
          width: '0%'
        });
        tick_counter = 1;
      }
      animation_timer = 3000;
      return $('#promo-slideshow .progress-indicator .fill').animate({
        width: "" + (tick_counter / ticks_before_slide * 100) + "%"
      }, animation_timer, 'linear');
    };
    advance_callback();
    advance_interval = setInterval(advance_callback, 3000);
    promo_callback = function() {
      var $selected, body_width, image_ratio;
      image_ratio = 315 / 710;
      body_width = $('body').width();
      if (body_width <= 1000) {
        $('#promo-wrap .image-promo').css({
          'height': (body_width * image_ratio) + 'px',
          'width': body_width
        });
        $('#promo-wrap .image-promo img').css({
          'height': '100%'
        });
      } else {
        $('#promo-wrap .image-promo').css({
          'height': 'inherit',
          'width': 'inherit'
        });
        $('#promo-wrap .image-promo img').css({
          'height': ''
        });
      }
      $selected = $('#promo-controls li').filter(function() {
        return $(this).hasClass('selected');
      });
      return advance_slideshow($selected.index());
    };
    $(window).resize(function() {
      return promo_callback();
    });
    if ($('body').innerWidth() <= 1000) {
      return promo_callback();
    }
  });

}).call(this);
